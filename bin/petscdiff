#! /bin/sh -f
#
#  Replaces floating point numbers with XXX and then does a diff
#
export RM="`grep 'RM =' ${PETSC_DIR}/${PETSC_ARCH}/lib/petsc/conf/petscvariables | sed s/'RM ='//g`"
export SED="`grep 'SED =' ${PETSC_DIR}/${PETSC_ARCH}/lib/petsc/conf/petscvariables | sed s/'SED ='//g`"
export DIFF="`grep 'DIFF =' ${PETSC_DIR}/${PETSC_ARCH}/lib/petsc/conf/petscvariables | sed s/'DIFF ='//g`"


${SED} "s/< [0-9][0-9]*\.*[0-9]*[eE][-+][0-9][0-9]*/XXX/g" $1 | ${SED} "s/[-]*[0-9][0-9]*\.*[0-9]*[eE][-+][0-9][0-9]*/XXX/g" | ${SED}  "s/[-]*[0-9][0-9]*\.[0-9]*/XXX/g"  > tmpA
${SED} "s/< [0-9][0-9]*\.*[0-9]*[eE][-+][0-9][0-9]*/XXX/g" $2 | ${SED} "s/[-]*[0-9][0-9]*\.*[0-9]*[eE][-+][0-9][0-9]*/XXX/g" | ${SED}  "s/[-]*[0-9][0-9]*\.[0-9]*/XXX/g"  > tmpB
${DIFF} tmpA tmpB > /dev/null
if [ $? -ne 0 ]; then
  ${DIFF} --suppress-common-lines -B  $1 $2 
  ${RM} -f tmpA tmpB
  exit 1;
else
  ${RM} -f tmpA tmpB
  exit 0;
fi


